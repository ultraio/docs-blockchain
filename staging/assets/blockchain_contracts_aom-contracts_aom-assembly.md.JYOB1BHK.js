import{_ as t,c as a,o as s,N as e}from"./chunks/framework.qSInOY95.js";const k=JSON.parse('{"title":"AOM Assembly Contract","description":"","frontmatter":{"title":"AOM Assembly Contract","order":104},"headers":[],"relativePath":"blockchain/contracts/aom-contracts/aom-assembly.md","filePath":"blockchain/contracts/aom-contracts/aom-assembly.md","lastUpdated":null}'),i={name:"blockchain/contracts/aom-contracts/aom-assembly.md"},n=e('<h1 id="aom-assembly-contract-aom-assembly" tabindex="-1">AOM Assembly Contract (aom.assembly) <a class="header-anchor" href="#aom-assembly-contract-aom-assembly" aria-label="Permalink to &quot;AOM Assembly Contract (aom.assembly)&quot;">​</a></h1><p>The AOM Assembly contract manages assembly line construction and operations within the Ash of Mankind ecosystem. This contract handles the creation of specialized production facilities that can manufacture complex items using patents and assembly line factories.</p><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p>The assembly contract enables players to:</p><ul><li>Build assembly lines on construction land using patent Uniqs</li><li>Manage assembly line construction timers</li><li>Upgrade assembly line production capabilities</li><li>Handle patent licensing and production rewards</li></ul><h2 id="tables" tabindex="-1">Tables <a class="header-anchor" href="#tables" aria-label="Permalink to &quot;Tables&quot;">​</a></h2><h3 id="configuration-tables" tabindex="-1">Configuration Tables <a class="header-anchor" href="#configuration-tables" aria-label="Permalink to &quot;Configuration Tables&quot;">​</a></h3><h4 id="global-singleton" tabindex="-1"><code>global</code> (Singleton) <a class="header-anchor" href="#global-singleton" aria-label="Permalink to &quot;`global` (Singleton)&quot;">​</a></h4><ul><li><strong>Scope</strong>: Contract (<code>aom.assembly</code>)</li><li><strong>Description</strong>: Global contract state</li></ul><table><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>locked</code></td><td><code>bool</code></td><td>Emergency lock status</td></tr></tbody></table><h4 id="asmblysttngs-singleton" tabindex="-1"><code>asmblysttngs</code> (Singleton) <a class="header-anchor" href="#asmblysttngs-singleton" aria-label="Permalink to &quot;`asmblysttngs` (Singleton)&quot;">​</a></h4><ul><li><strong>Scope</strong>: Contract (<code>aom.assembly</code>)</li><li><strong>Description</strong>: Assembly line configuration</li></ul><table><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>required_factory_id</code></td><td><code>uint64_t</code></td><td>Factory ID for assembly line factory Uniqs</td></tr><tr><td><code>construction_duration_sec</code></td><td><code>uint32_t</code></td><td>Construction time in seconds</td></tr><tr><td><code>building_fee</code></td><td><code>map&lt;symbol, uint64_t&gt;</code></td><td>Required fees for construction</td></tr><tr><td><code>instant_construction_fee</code></td><td><code>map&lt;symbol, uint64_t&gt;</code></td><td>Fees for instant completion</td></tr><tr><td><code>production_upgrade_fee</code></td><td><code>map&lt;symbol, uint64_t&gt;</code></td><td>Fees for production upgrades</td></tr><tr><td><code>production_speed_upgrade_increment</code></td><td><code>uint64_t</code></td><td>Speed increase per upgrade (precision: 2)</td></tr><tr><td><code>max_production_speed</code></td><td><code>uint64_t</code></td><td>Maximum production speed (precision: 2)</td></tr></tbody></table><h4 id="metadata-multi-index" tabindex="-1"><code>metadata</code> (Multi-Index) <a class="header-anchor" href="#metadata-multi-index" aria-label="Permalink to &quot;`metadata` (Multi-Index)&quot;">​</a></h4><ul><li><strong>Scope</strong>: Contract (<code>aom.assembly</code>)</li><li><strong>Primary Key</strong>: <code>patent_factory_id</code></li></ul><table><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>patent_factory_id</code></td><td><code>uint64_t</code></td><td>Patent Uniq factory ID</td></tr><tr><td><code>metadata_url</code></td><td><code>string</code></td><td>JSON metadata URL for assembly lines</td></tr><tr><td><code>metadata_hash</code></td><td><code>checksum256</code></td><td>Metadata content hash</td></tr></tbody></table><h3 id="operational-tables" tabindex="-1">Operational Tables <a class="header-anchor" href="#operational-tables" aria-label="Permalink to &quot;Operational Tables&quot;">​</a></h3><h4 id="construction-multi-index" tabindex="-1"><code>construction</code> (Multi-Index) <a class="header-anchor" href="#construction-multi-index" aria-label="Permalink to &quot;`construction` (Multi-Index)&quot;">​</a></h4><ul><li><strong>Scope</strong>: Contract (<code>aom.assembly</code>)</li><li><strong>Primary Key</strong>: <code>uniq_id</code></li></ul><table><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>uniq_id</code></td><td><code>uint64_t</code></td><td>Assembly line factory Uniq under construction</td></tr><tr><td><code>patent_factory_id</code></td><td><code>uint64_t</code></td><td>Patent factory ID used for construction</td></tr><tr><td><code>completion_block_time</code></td><td><code>uint32_t</code></td><td>When construction completes</td></tr></tbody></table><h4 id="feebuffer-singleton" tabindex="-1"><code>feebuffer</code> (Singleton) <a class="header-anchor" href="#feebuffer-singleton" aria-label="Permalink to &quot;`feebuffer` (Singleton)&quot;">​</a></h4><ul><li><strong>Scope</strong>: User account</li><li><strong>Description</strong>: Buffered fees for multi-asset payments</li></ul><table><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>action_type</code></td><td><code>string</code></td><td>Type of action being paid for</td></tr><tr><td><code>factory_uniq_id</code></td><td><code>uint64_t</code></td><td>Factory Uniq ID (or upgrade count for production upgrades)</td></tr><tr><td><code>fee</code></td><td><code>map&lt;symbol, uint64_t&gt;</code></td><td>Accumulated fees by asset</td></tr></tbody></table><h2 id="actions" tabindex="-1">Actions <a class="header-anchor" href="#actions" aria-label="Permalink to &quot;Actions&quot;">​</a></h2><h3 id="administrative-actions" tabindex="-1">Administrative Actions <a class="header-anchor" href="#administrative-actions" aria-label="Permalink to &quot;Administrative Actions&quot;">​</a></h3><h4 id="updasmbsttng" tabindex="-1"><code>updasmbsttng</code> <a class="header-anchor" href="#updasmbsttng" aria-label="Permalink to &quot;`updasmbsttng`&quot;">​</a></h4><p>Updates assembly line settings.</p><p><strong>Authorization</strong>: Contract (<code>aom.assembly</code>)</p><p><strong>Parameters</strong>:</p><table><thead><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>row</code></td><td><code>assembly_settings</code></td><td>New assembly settings</td></tr></tbody></table><p><strong>Behavior</strong>: Sets global assembly line parameters including construction duration and upgrade fees.</p><p><strong>CLI Example</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cleos</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> push</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> action</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aom.assembly</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> updasmbsttng</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{&quot;row&quot;: {&quot;required_factory_id&quot;: 300, &quot;construction_duration_sec&quot;: 7200, &quot;building_fee&quot;: [[&quot;4,ASH&quot;, 2000], [&quot;4,STEEL&quot;, 100]], &quot;instant_construction_fee&quot;: [[&quot;4,ASH&quot;, 10000]], &quot;production_upgrade_fee&quot;: [[&quot;4,ASH&quot;, 1500]], &quot;production_speed_upgrade_increment&quot;: 50, &quot;max_production_speed&quot;: 400}}&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aom.assembly@active</span></span></code></pre></div><h4 id="updmetadata" tabindex="-1"><code>updmetadata</code> <a class="header-anchor" href="#updmetadata" aria-label="Permalink to &quot;`updmetadata`&quot;">​</a></h4><p>Updates metadata mapping for patent types.</p><p><strong>Authorization</strong>: Contract (<code>aom.assembly</code>)</p><p><strong>Parameters</strong>:</p><table><thead><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>row</code></td><td><code>metadata</code></td><td>Metadata configuration</td></tr></tbody></table><p><strong>Behavior</strong>: Maps patent factory IDs to their corresponding assembly line metadata.</p><p><strong>CLI Example</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cleos</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> push</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> action</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aom.assembly</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> updmetadata</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{&quot;row&quot;: {&quot;patent_factory_id&quot;: 400, &quot;metadata_url&quot;: &quot;https://example.com/sword-assembly.json&quot;, &quot;metadata_hash&quot;: &quot;def456...&quot;}}&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aom.assembly@active</span></span></code></pre></div><h4 id="setlocked" tabindex="-1"><code>setlocked</code> <a class="header-anchor" href="#setlocked" aria-label="Permalink to &quot;`setlocked`&quot;">​</a></h4><p>Emergency lock/unlock the contract.</p><p><strong>Authorization</strong>: Contract (<code>aom.assembly</code>)</p><p><strong>Parameters</strong>:</p><table><thead><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>locked</code></td><td><code>bool</code></td><td>Lock status</td></tr></tbody></table><p><strong>CLI Example</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cleos</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> push</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> action</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aom.assembly</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> setlocked</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{&quot;locked&quot;: true}&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aom.assembly@active</span></span></code></pre></div><h3 id="gameplay-actions" tabindex="-1">Gameplay Actions <a class="header-anchor" href="#gameplay-actions" aria-label="Permalink to &quot;Gameplay Actions&quot;">​</a></h3><h4 id="cutribbon" tabindex="-1"><code>cutribbon</code> <a class="header-anchor" href="#cutribbon" aria-label="Permalink to &quot;`cutribbon`&quot;">​</a></h4><p>Completes assembly line construction.</p><p><strong>Authorization</strong>: Uniq owner</p><p><strong>Parameters</strong>:</p><table><thead><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>uniq_id</code></td><td><code>uint64_t</code></td><td>Assembly line factory Uniq to complete</td></tr><tr><td><code>uniq_owner</code></td><td><code>name</code></td><td>Owner of the factory Uniq</td></tr></tbody></table><p><strong>Behavior</strong>:</p><ul><li>Validates construction is complete (time elapsed)</li><li>Updates factory metadata with assembly line type</li><li>Sets initial production speed to 1 (0.01x speed)</li><li>Updates JSON metadata based on patent type</li><li>Removes construction timer entry</li></ul><p><strong>CLI Example</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cleos</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> push</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> action</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aom.assembly</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cutribbon</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{&quot;uniq_id&quot;: 12345, &quot;uniq_owner&quot;: &quot;alice&quot;}&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> alice@active</span></span></code></pre></div><h4 id="clearbuffer" tabindex="-1"><code>clearbuffer</code> <a class="header-anchor" href="#clearbuffer" aria-label="Permalink to &quot;`clearbuffer`&quot;">​</a></h4><p>Clears fee buffer and refunds assets.</p><p><strong>Authorization</strong>: User</p><p><strong>Parameters</strong>:</p><table><thead><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>user</code></td><td><code>name</code></td><td>User to clear buffer for</td></tr></tbody></table><p><strong>CLI Example</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cleos</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> push</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> action</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aom.assembly</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clearbuffer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{&quot;user&quot;: &quot;alice&quot;}&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> alice@active</span></span></code></pre></div><h2 id="token-transfer-actions" tabindex="-1">Token Transfer Actions <a class="header-anchor" href="#token-transfer-actions" aria-label="Permalink to &quot;Token Transfer Actions&quot;">​</a></h2><p>The contract accepts token transfers for assembly line operations through the <code>on_transfer</code> notification.</p><h3 id="assembly-line-construction" tabindex="-1">Assembly Line Construction <a class="header-anchor" href="#assembly-line-construction" aria-label="Permalink to &quot;Assembly Line Construction&quot;">​</a></h3><p><strong>Memo Format</strong>: <code>BuildAssemblyLine,&lt;factory_uniq_id&gt;[,&lt;patent_uniq_id&gt;]</code></p><p><strong>Two-Phase Process</strong>:</p><ol><li><strong>Fee Collection</strong>: Send required assets without patent_uniq_id to accumulate fees</li><li><strong>Construction Start</strong>: Send final asset with patent_uniq_id to begin construction</li></ol><p><strong>Validation</strong>:</p><ul><li>Factory Uniq must be from correct assembly line factory</li><li>Patent Uniq must be owned by user</li><li>All required fees must be paid</li></ul><p><strong>Examples</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Phase 1: Send construction fees</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cleos</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> transfer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> alice</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aom.assembly</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;2000.0000 ASH&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;BuildAssemblyLine,12345&quot;</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cleos</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> transfer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> alice</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aom.assembly</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;100.0000 STEEL&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;BuildAssemblyLine,12345&quot;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Phase 2: Start construction with patent</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cleos</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> transfer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> alice</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aom.assembly</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;0.0001 ASH&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;BuildAssemblyLine,12345,67890&quot;</span></span></code></pre></div><h3 id="instant-assembly-construction" tabindex="-1">Instant Assembly Construction <a class="header-anchor" href="#instant-assembly-construction" aria-label="Permalink to &quot;Instant Assembly Construction&quot;">​</a></h3><p><strong>Memo Format</strong>: <code>AssemblyInstantConstruction,&lt;factory_uniq_id&gt;[,&lt;patent_uniq_id&gt;]</code></p><p><strong>Two-Phase Process</strong>:</p><ol><li><strong>Fee Collection</strong>: Send required assets without patent_uniq_id</li><li><strong>Instant Completion</strong>: Send final asset with patent_uniq_id to instantly complete</li></ol><p><strong>Behavior</strong>:</p><ul><li>Sets completion time to current block time</li><li>Allows immediate <code>cutribbon</code> call</li></ul><p><strong>Examples</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Phase 1: Send instant construction fees</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cleos</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> transfer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> alice</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aom.assembly</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;10000.0000 ASH&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;AssemblyInstantConstruction,12345&quot;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Phase 2: Complete instantly with patent</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cleos</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> transfer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> alice</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aom.assembly</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;0.0001 ASH&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;AssemblyInstantConstruction,12345,67890&quot;</span></span></code></pre></div><h3 id="production-speed-upgrades" tabindex="-1">Production Speed Upgrades <a class="header-anchor" href="#production-speed-upgrades" aria-label="Permalink to &quot;Production Speed Upgrades&quot;">​</a></h3><p><strong>Memo Format</strong>: <code>UpgradeProductionSpeed[,&lt;factory_uniq_id&gt;]</code></p><p><strong>Two-Phase Process</strong>:</p><ol><li><strong>Fee Collection</strong>: Send upgrade fees without factory_uniq_id (fees determine upgrade count)</li><li><strong>Upgrade Application</strong>: Send final fee with factory_uniq_id to apply upgrades</li></ol><p><strong>Examples</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Phase 1: Send upgrade fees (for 3 upgrades)</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cleos</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> transfer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> alice</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aom.assembly</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;4500.0000 ASH&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;UpgradeProductionSpeed&quot;</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Phase 2: Apply upgrades to assembly line</span></span>\n<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cleos</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> transfer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> alice</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aom.assembly</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;0.0001 ASH&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;UpgradeProductionSpeed,12345&quot;</span></span></code></pre></div><h3 id="fee-transfers" tabindex="-1">Fee Transfers <a class="header-anchor" href="#fee-transfers" aria-label="Permalink to &quot;Fee Transfers&quot;">​</a></h3><p>The contract also handles special transfers for patent licensing and production rewards:</p><h4 id="transfer-order-permit-fee" tabindex="-1">Transfer Order Permit Fee <a class="header-anchor" href="#transfer-order-permit-fee" aria-label="Permalink to &quot;Transfer Order Permit Fee&quot;">​</a></h4><p><strong>Memo Format</strong>: <code>TransferOrderPermitFee,&lt;patent_uniq_id&gt;,&lt;uniq_owner&gt;</code></p><p>Transfers fees related to patent usage permissions.</p><h4 id="transfer-production-reward" tabindex="-1">Transfer Production Reward <a class="header-anchor" href="#transfer-production-reward" aria-label="Permalink to &quot;Transfer Production Reward&quot;">​</a></h4><p><strong>Memo Format</strong>: <code>TransferProductionReward,&lt;factory_uniq_id&gt;,&lt;uniq_owner&gt;</code></p><p>Transfers production rewards to assembly line operators.</p><h2 id="assembly-line-mechanics" tabindex="-1">Assembly Line Mechanics <a class="header-anchor" href="#assembly-line-mechanics" aria-label="Permalink to &quot;Assembly Line Mechanics&quot;">​</a></h2><h3 id="construction-requirements" tabindex="-1">Construction Requirements <a class="header-anchor" href="#construction-requirements" aria-label="Permalink to &quot;Construction Requirements&quot;">​</a></h3><p>Assembly line construction requires:</p><ol><li><strong>Assembly Line Factory Uniq</strong>: Must be from the configured factory ID</li><li><strong>Patent Uniq</strong>: Must own a patent that defines what can be produced</li><li><strong>Construction Fees</strong>: Multi-asset payment for building materials</li></ol><h3 id="patent-integration" tabindex="-1">Patent Integration <a class="header-anchor" href="#patent-integration" aria-label="Permalink to &quot;Patent Integration&quot;">​</a></h3><p>Patents define what assembly lines can produce:</p><ul><li><strong>Patent Factory ID</strong>: Determines the type of items that can be manufactured</li><li><strong>Metadata Mapping</strong>: Links patent types to assembly line visual assets</li><li><strong>Production Licensing</strong>: Patent ownership grants production rights</li></ul><h3 id="production-speed-system" tabindex="-1">Production Speed System <a class="header-anchor" href="#production-speed-system" aria-label="Permalink to &quot;Production Speed System&quot;">​</a></h3><p>Assembly lines start with minimal production speed and can be upgraded:</p><ul><li><strong>Initial Speed</strong>: 1 (0.01x speed, precision: 2)</li><li><strong>Upgrade Increment</strong>: Configurable speed increase per upgrade</li><li><strong>Maximum Speed</strong>: Configurable upper limit</li><li><strong>Upgrade Cost</strong>: Multi-asset fees for speed improvements</li></ul><h2 id="integration-with-on-chain-data" tabindex="-1">Integration with On-Chain Data <a class="header-anchor" href="#integration-with-on-chain-data" aria-label="Permalink to &quot;Integration with On-Chain Data&quot;">​</a></h2><h3 id="factory-metadata-management" tabindex="-1">Factory Metadata Management <a class="header-anchor" href="#factory-metadata-management" aria-label="Permalink to &quot;Factory Metadata Management&quot;">​</a></h3><p>Assembly lines update their on-chain metadata during construction:</p><ol><li><strong>AssemblyType</strong>: Set to the type of assembly line being built</li><li><strong>ProductionSpeed</strong>: Initially set to minimum value (1)</li></ol><h3 id="patent-validation" tabindex="-1">Patent Validation <a class="header-anchor" href="#patent-validation" aria-label="Permalink to &quot;Patent Validation&quot;">​</a></h3><p>The contract validates patent Uniqs to ensure proper licensing:</p><ul><li><strong>Ownership Verification</strong>: User must own the patent being used</li><li><strong>Patent Type</strong>: Patent factory ID determines assembly line capabilities</li></ul><h3 id="metadata-updates" tabindex="-1">Metadata Updates <a class="header-anchor" href="#metadata-updates" aria-label="Permalink to &quot;Metadata Updates&quot;">​</a></h3><p>The contract updates both on-chain key-value data and JSON metadata:</p><ul><li><strong>On-Chain Data</strong>: Stores operational parameters (type, speed)</li><li><strong>JSON Metadata</strong>: Visual representation based on patent type</li></ul><h2 id="cross-contract-integration" tabindex="-1">Cross-Contract Integration <a class="header-anchor" href="#cross-contract-integration" aria-label="Permalink to &quot;Cross-Contract Integration&quot;">​</a></h2><h3 id="permission-management" tabindex="-1">Permission Management <a class="header-anchor" href="#permission-management" aria-label="Permalink to &quot;Permission Management&quot;">​</a></h3><p>The contract uses specific permissions for operations:</p><ul><li><strong>AOM_UNIQS</strong> account for metadata updates</li><li><strong>setvalsa</strong> permission for on-chain data modifications</li><li><strong>settknmeta</strong> permission for JSON metadata updates</li></ul><h3 id="asset-handling" tabindex="-1">Asset Handling <a class="header-anchor" href="#asset-handling" aria-label="Permalink to &quot;Asset Handling&quot;">​</a></h3><p>Like other AOM contracts:</p><ul><li><strong>ASH Tokens</strong>: Transferred to <code>aom.vault</code> as revenue</li><li><strong>Other Tokens</strong>: Transferred to <code>aom.coins</code> for retirement</li></ul><h2 id="fee-management" tabindex="-1">Fee Management <a class="header-anchor" href="#fee-management" aria-label="Permalink to &quot;Fee Management&quot;">​</a></h2><h3 id="multi-asset-construction-fees" tabindex="-1">Multi-Asset Construction Fees <a class="header-anchor" href="#multi-asset-construction-fees" aria-label="Permalink to &quot;Multi-Asset Construction Fees&quot;">​</a></h3><p>Assembly line construction requires various materials:</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Example fee structure</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">building_fee: [</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;4,ASH&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     // 2000 ASH tokens</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;4,STEEL&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 100 STEEL tokens</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;4,COPPER&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     // 50 COPPER tokens</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><h3 id="upgrade-fee-calculation" tabindex="-1">Upgrade Fee Calculation <a class="header-anchor" href="#upgrade-fee-calculation" aria-label="Permalink to &quot;Upgrade Fee Calculation&quot;">​</a></h3><p>Production speed upgrades use proportional fees:</p><div class="language-cpp vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Number of upgrades = total_fee_amount / individual_upgrade_fee</span></span>\n<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">upgrade_count </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> transfer_amount </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> upgrade_fee_per_upgrade</span></span></code></pre></div><h3 id="fee-buffering-process" tabindex="-1">Fee Buffering Process <a class="header-anchor" href="#fee-buffering-process" aria-label="Permalink to &quot;Fee Buffering Process&quot;">​</a></h3><ol><li><strong>Accumulation</strong>: Players send assets incrementally</li><li><strong>Validation</strong>: Contract validates each asset type and amount</li><li><strong>Execution</strong>: When all fees collected, operation executes</li><li><strong>Settlement</strong>: Fees distributed to vault or retired</li></ol><h2 id="security-considerations" tabindex="-1">Security Considerations <a class="header-anchor" href="#security-considerations" aria-label="Permalink to &quot;Security Considerations&quot;">​</a></h2><ul><li><strong>Ownership Validation</strong>: Strict validation of both factory and patent ownership</li><li><strong>Patent Verification</strong>: Ensures users own patents they&#39;re using for construction</li><li><strong>Fee Integrity</strong>: Robust validation prevents fee manipulation</li><li><strong>Time Validation</strong>: Ensures construction timers are properly enforced</li><li><strong>State Consistency</strong>: Prevents invalid assembly line states</li><li><strong>Emergency Controls</strong>: Contract locking for emergency situations</li></ul><h2 id="query-examples" tabindex="-1">Query Examples <a class="header-anchor" href="#query-examples" aria-label="Permalink to &quot;Query Examples&quot;">​</a></h2><h3 id="get-assembly-settings" tabindex="-1">Get Assembly Settings <a class="header-anchor" href="#get-assembly-settings" aria-label="Permalink to &quot;Get Assembly Settings&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cleos</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aom.assembly</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aom.assembly</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> asmblysttngs</span></span></code></pre></div><h3 id="get-patent-metadata-mappings" tabindex="-1">Get Patent Metadata Mappings <a class="header-anchor" href="#get-patent-metadata-mappings" aria-label="Permalink to &quot;Get Patent Metadata Mappings&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cleos</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aom.assembly</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aom.assembly</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> metadata</span></span></code></pre></div><h3 id="get-active-construction" tabindex="-1">Get Active Construction <a class="header-anchor" href="#get-active-construction" aria-label="Permalink to &quot;Get Active Construction&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cleos</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aom.assembly</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aom.assembly</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> construction</span></span></code></pre></div><h3 id="get-user-fee-buffer" tabindex="-1">Get User Fee Buffer <a class="header-anchor" href="#get-user-fee-buffer" aria-label="Permalink to &quot;Get User Fee Buffer&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cleos</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> aom.assembly</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> alice</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> feebuffer</span></span></code></pre></div>',144),o=[n];function r(l,d,h,p,c,u){return s(),a("div",null,o)}const m=t(i,[["render",r]]);export{k as __pageData,m as default};
